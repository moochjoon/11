/* ============================================================
   BASE.CSS  —  Namak Messenger
   Reset, typography, scrollbar, selection, focus,
   utility classes
   ============================================================ */

/* ──────────────────────────────────────────────────────────
   1. RESET
────────────────────────────────────────────────────────── */
*, *::before, *::after {
    box-sizing:  border-box;
    margin:      0;
    padding:     0;
    border:      0;
    min-width:   0;
}

html {
    font-size:              100%;
    -webkit-text-size-adjust: 100%;
    text-size-adjust:         100%;
    height:                 100%;
    scroll-behavior:        smooth;
}

body {
    font-family:       var(--font-family);
    font-size:         var(--font-size-base);
    font-weight:       var(--font-weight-normal);
    line-height:       var(--line-height);
    color:             var(--text-primary);
    background:        var(--bg-app);
    min-height:        100%;
    min-height:        100dvh;
    overflow:          hidden;
    -webkit-font-smoothing:  antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering:    optimizeLegibility;
    direction:         rtl;
}

img, video, svg { display: block; max-width: 100%; }
img             { object-fit: cover; }
a               { color: var(--text-link); text-decoration: none; }
a:hover         { text-decoration: underline; }
ul, ol          { list-style: none; }
button          { cursor: pointer; background: none; font: inherit; color: inherit; }
input, textarea, select {
    font:    inherit;
    color:   inherit;
    outline: none;
}
textarea        { resize: vertical; }
table           { border-collapse: collapse; border-spacing: 0; }
hr              { border: none; border-top: 1px solid var(--border); margin: var(--sp-4) 0; }

/* ──────────────────────────────────────────────────────────
   2. SCROLLBAR
────────────────────────────────────────────────────────── */
* {
    scrollbar-width:       thin;
    scrollbar-color:       var(--scrollbar-thumb) var(--scrollbar-track);
}
*::-webkit-scrollbar          { width: var(--scrollbar-w); height: var(--scrollbar-w); }
*::-webkit-scrollbar-thumb    { background: var(--scrollbar-thumb); border-radius: var(--radius-full); }
*::-webkit-scrollbar-track    { background: var(--scrollbar-track); }
*::-webkit-scrollbar-corner   { background: transparent; }

/* ──────────────────────────────────────────────────────────
   3. SELECTION
────────────────────────────────────────────────────────── */
::selection {
    background: var(--brand-alpha-20);
    color:      var(--text-primary);
}

/* ──────────────────────────────────────────────────────────
   4. FOCUS VISIBLE
────────────────────────────────────────────────────────── */
:focus-visible {
    outline:        2px solid var(--brand);
    outline-offset: 2px;
    border-radius:  var(--radius-sm);
}
:focus:not(:focus-visible) { outline: none; }

/* ──────────────────────────────────────────────────────────
   5. TYPOGRAPHY
────────────────────────────────────────────────────────── */
h1 { font-size: var(--font-size-3xl); font-weight: var(--font-weight-bold); }
h2 { font-size: var(--font-size-2xl); font-weight: var(--font-weight-bold); }
h3 { font-size: var(--font-size-xl);  font-weight: var(--font-weight-semi); }
h4 { font-size: var(--font-size-lg);  font-weight: var(--font-weight-semi); }
h5 { font-size: var(--font-size-md);  font-weight: var(--font-weight-medium);}
h6 { font-size: var(--font-size-base);font-weight: var(--font-weight-medium);}

p  { line-height: var(--line-height); }

code, pre {
    font-family: var(--font-family-mono);
    font-size:   .9em;
}
pre {
    overflow-x: auto;
    padding:    var(--sp-4);
    background: var(--bg-surface-2);
    border-radius: var(--radius-md);
}

/* ──────────────────────────────────────────────────────────
   6. UTILITY CLASSES
────────────────────────────────────────────────────────── */

/* Display */
.hidden        { display:     none !important; }
.invisible     { visibility:  hidden; }
.flex          { display:     flex; }
.flex-col      { display:     flex; flex-direction: column; }
.flex-center   { display:     flex; align-items: center; justify-content: center; }
.flex-between  { display:     flex; align-items: center; justify-content: space-between; }
.flex-wrap     { flex-wrap:   wrap; }
.flex-1        { flex:        1; }
.flex-shrink-0 { flex-shrink: 0; }
.grid          { display:     grid; }
.inline        { display:     inline; }
.inline-flex   { display:     inline-flex; align-items: center; }
.block         { display:     block; }

/* Overflow */
.overflow-hidden  { overflow:   hidden; }
.overflow-auto    { overflow:   auto; }
.overflow-y-auto  { overflow-y: auto; }
.overflow-x-auto  { overflow-x: auto; }
.truncate {
    overflow:      hidden;
    text-overflow: ellipsis;
    white-space:   nowrap;
}

/* Text */
.text-xs      { font-size: var(--font-size-xs); }
.text-sm      { font-size: var(--font-size-sm); }
.text-base    { font-size: var(--font-size-base); }
.text-md      { font-size: var(--font-size-md); }
.text-lg      { font-size: var(--font-size-lg); }
.text-bold    { font-weight: var(--font-weight-bold); }
.text-semi    { font-weight: var(--font-weight-semi); }
.text-medium  { font-weight: var(--font-weight-medium); }
.text-muted   { color: var(--text-secondary); }
.text-danger  { color: var(--danger); }
.text-success { color: var(--success); }
.text-center  { text-align: center; }
.text-start   { text-align: start; }
.text-end     { text-align: end; }
.ltr          { direction: ltr; }
.rtl          { direction: rtl; }
.ltr-num      { font-feature-settings: 'tnum'; direction: ltr; display: inline-block; }

/* Spacing */
.gap-1  { gap: var(--sp-1); }
.gap-2  { gap: var(--sp-2); }
.gap-3  { gap: var(--sp-3); }
.gap-4  { gap: var(--sp-4); }
.mt-2   { margin-top:    var(--sp-2); }
.mt-4   { margin-top:    var(--sp-4); }
.mb-2   { margin-bottom: var(--sp-2); }
.mb-4   { margin-bottom: var(--sp-4); }
.p-4    { padding: var(--sp-4); }
.px-4   { padding-inline: var(--sp-4); }
.py-2   { padding-block:  var(--sp-2); }

/* Position */
.relative { position: relative; }
.absolute { position: absolute; }
.fixed    { position: fixed; }
.sticky   { position: sticky; }
.inset-0  { inset: 0; }

/* Size */
.w-full   { width:  100%; }
.h-full   { height: 100%; }
.min-h-0  { min-height: 0; }

/* Interaction */
.pointer         { cursor: pointer; }
.no-select       { user-select: none; }
.no-pointer      { pointer-events: none; }
.touch-action-none { touch-action: none; }

/* Visual */
.rounded-full { border-radius: var(--radius-full); }
.rounded      { border-radius: var(--radius-md); }
.opacity-50   { opacity: .5; }
.opacity-0    { opacity: 0; }

/* Accessibility */
.sr-only {
    position:   absolute;
    width:      1px;
    height:     1px;
    padding:    0;
    margin:     -1px;
    overflow:   hidden;
    clip:       rect(0,0,0,0);
    white-space:nowrap;
    border:     0;
}

/* ──────────────────────────────────────────────────────────
   7. SPINNER
────────────────────────────────────────────────────────── */
.spinner {
    width:          32px;
    height:         32px;
    border:         3px solid var(--border);
    border-top-color: var(--brand);
    border-radius:  50%;
    animation:      spin 700ms linear infinite;
    margin:         auto;
}
.spinner--sm { width: 18px; height: 18px; border-width: 2px; }
.spinner--lg { width: 48px; height: 48px; border-width: 4px; }

/* ──────────────────────────────────────────────────────────
   8. AVATAR
────────────────────────────────────────────────────────── */
.avatar {
    border-radius:  50%;
    flex-shrink:    0;
    display:        flex;
    align-items:    center;
    justify-content:center;
    overflow:       hidden;
    position:       relative;
}
.avatar--img     { background: var(--bg-surface-2); }
.avatar--fallback{
    background:    var(--avatar-bg, var(--brand));
    color:         var(--avatar-fg, #fff);
    font-weight:   var(--font-weight-semi);
    font-size:     .38em;
    letter-spacing:-.02em;
}
.avatar--xs   { width: var(--avatar-xs);  height: var(--avatar-xs);  font-size: 10px; }
.avatar--sm   { width: var(--avatar-sm);  height: var(--avatar-sm);  font-size: 13px; }
.avatar--md   { width: var(--avatar-md);  height: var(--avatar-md);  font-size: 17px; }
.avatar--lg   { width: var(--avatar-lg);  height: var(--avatar-lg);  font-size: 22px; }
.avatar--xl   { width: var(--avatar-xl);  height: var(--avatar-xl);  font-size: 30px; }
.avatar--2xl  { width: var(--avatar-2xl); height: var(--avatar-2xl); font-size: 44px; }
.avatar--img img { width: 100%; height: 100%; object-fit: cover; }

.avatar__online {
    position:     absolute;
    bottom:       1px;
    inset-inline-end: 1px;
    width:        10px;
    height:       10px;
    background:   var(--online);
    border-radius:50%;
    border:       2px solid var(--bg-sidebar);
}

/* Story ring */
.has-story .avatar {
    outline:        2px solid var(--brand);
    outline-offset: 2px;
}

/* ──────────────────────────────────────────────────────────
   9. BUTTON BASE
────────────────────────────────────────────────────────── */
.btn {
    display:        inline-flex;
    align-items:    center;
    justify-content:center;
    gap:            var(--sp-2);
    padding:        10px 18px;
    border-radius:  var(--radius-lg);
    font-size:      var(--font-size-md);
    font-weight:    var(--font-weight-semi);
    line-height:    1;
    white-space:    nowrap;
    transition:     background var(--transition-fast),
    color       var(--transition-fast),
    transform   var(--transition-fast),
    opacity     var(--transition-fast),
    box-shadow  var(--transition-fast);
    user-select:    none;
}
.btn:active                 { transform: scale(.97); }
.btn:disabled               { opacity: .45; cursor: not-allowed; pointer-events: none; }

.btn--primary {
    background: var(--brand);
    color:      #fff;
    box-shadow: 0 2px 8px var(--brand-alpha-20);
}
.btn--primary:hover         { background: var(--brand-dark); }

.btn--ghost {
    background: transparent;
    color:      var(--text-primary);
    border:     1px solid var(--border-strong);
}
.btn--ghost:hover           { background: var(--bg-surface-2); }

.btn--danger {
    background: var(--danger);
    color:      #fff;
}
.btn--danger:hover          { background: #e0352b; }

.btn--text {
    background: transparent;
    color:      var(--brand);
    padding:    6px 10px;
}
.btn--text:hover            { background: var(--brand-alpha-10); }

.btn--sm  { padding: 7px 14px; font-size: var(--font-size-sm);  border-radius: var(--radius-md); }
.btn--lg  { padding: 14px 24px;font-size: var(--font-size-lg);  border-radius: var(--radius-xl); }
.btn--full{ width: 100%; }
.btn--icon{
    padding:      8px;
    border-radius:var(--radius-full);
    width:        36px;
    height:       36px;
}
.btn--icon svg { width: 20px; height: 20px; }

/* ──────────────────────────────────────────────────────────
   10. INPUT BASE
────────────────────────────────────────────────────────── */
.input {
    width:          100%;
    padding:        10px 14px;
    background:     var(--bg-input);
    border:         1px solid transparent;
    border-radius:  var(--radius-lg);
    font-size:      var(--font-size-base);
    color:          var(--text-primary);
    transition:     border-color var(--transition-fast),
    background   var(--transition-fast);
}
.input::placeholder         { color: var(--text-tertiary); }
.input:hover                { border-color: var(--border-strong); }
.input:focus                { border-color: var(--brand); background: var(--bg-surface); }
.input--error               { border-color: var(--danger); }
.input--sm                  { padding: 7px 11px; font-size: var(--font-size-sm); border-radius: var(--radius-md); }

textarea.input              { min-height: 80px; }

/* ──────────────────────────────────────────────────────────
   11. SWITCH TOGGLE
────────────────────────────────────────────────────────── */
.switch-input {
    position:  absolute;
    opacity:   0;
    width:     0;
    height:    0;
    pointer-events: none;
}

.switch-thumb {
    display:       inline-block;
    width:         44px;
    height:        26px;
    background:    var(--bg-surface-3);
    border-radius: var(--radius-full);
    position:      relative;
    flex-shrink:   0;
    cursor:        pointer;
    transition:    background var(--transition-base);
}
.switch-thumb::after {
    content:       '';
    position:      absolute;
    top:           3px;
    inset-inline-end: 3px;
    width:         20px;
    height:        20px;
    background:    #fff;
    border-radius: 50%;
    box-shadow:    var(--shadow-xs);
    transition:    inset-inline-end var(--transition-spring),
    background       var(--transition-base);
}
.switch-input:checked + .switch-thumb {
    background: var(--brand);
}
.switch-input:checked + .switch-thumb::after {
    inset-inline-end: calc(100% - 23px);
}

/* ──────────────────────────────────────────────────────────
   12. BADGE
────────────────────────────────────────────────────────── */
.badge {
    display:        inline-flex;
    align-items:    center;
    justify-content:center;
    min-width:      18px;
    height:         18px;
    padding:        0 5px;
    background:     var(--brand);
    color:          #fff;
    font-size:      var(--font-size-xs);
    font-weight:    var(--font-weight-bold);
    border-radius:  var(--radius-full);
    line-height:    1;
}
.badge--muted   { background: var(--text-tertiary); }
.badge--danger  { background: var(--danger); }

/* ──────────────────────────────────────────────────────────
   13. CHIP
────────────────────────────────────────────────────────── */
.chip {
    display:        inline-flex;
    align-items:    center;
    gap:            var(--sp-1);
    padding:        4px 10px;
    background:     var(--brand-alpha-10);
    color:          var(--brand);
    border-radius:  var(--radius-full);
    font-size:      var(--font-size-sm);
    font-weight:    var(--font-weight-medium);
}
.chip__remove {
    width:          16px;
    height:         16px;
    border-radius:  50%;
    display:        flex;
    align-items:    center;
    justify-content:center;
    font-size:      12px;
    opacity:        .7;
    transition:     opacity var(--transition-fast);
}
.chip__remove:hover { opacity: 1; }

/* ──────────────────────────────────────────────────────────
   14. DIVIDER
────────────────────────────────────────────────────────── */
.divider {
    display:        flex;
    align-items:    center;
    gap:            var(--sp-3);
    color:          var(--text-tertiary);
    font-size:      var(--font-size-xs);
    margin:         var(--sp-4) 0;
}
.divider::before, .divider::after {
    content:        '';
    flex:           1;
    height:         1px;
    background:     var(--border);
}

/* ──────────────────────────────────────────────────────────
   15. EMPTY STATE
────────────────────────────────────────────────────────── */
.empty-state {
    display:        flex;
    flex-direction: column;
    align-items:    center;
    justify-content:center;
    gap:            var(--sp-3);
    padding:        var(--sp-10);
    color:          var(--text-tertiary);
    text-align:     center;
}
.empty-state__icon { font-size: 48px; line-height: 1; }
.empty-state__title{
    font-size:   var(--font-size-lg);
    font-weight: var(--font-weight-semi);
    color:       var(--text-secondary);
}
.empty-state__text { font-size: var(--font-size-sm); max-width: 240px; }

/* ──────────────────────────────────────────────────────────
   16. TOAST
────────────────────────────────────────────────────────── */
#toast-container {
    position:  fixed;
    bottom:    var(--sp-6);
    inset-inline-start: 50%;
    transform: translateX(-50%);
    z-index:   var(--z-toast);
    display:   flex;
    flex-direction: column-reverse;
    align-items: center;
    gap:       var(--sp-2);
    pointer-events: none;
}

.toast {
    display:        flex;
    align-items:    center;
    gap:            var(--sp-3);
    padding:        10px 16px;
    background:     var(--bg-tooltip);
    color:          #fff;
    border-radius:  var(--radius-lg);
    font-size:      var(--font-size-sm);
    box-shadow:     var(--shadow-lg);
    pointer-events: all;
    max-width:      360px;
    animation:      toastIn 200ms var(--transition-spring) forwards;
}
.toast--success { background: #1a4731; }
.toast--error   { background: #4c1b18; }
.toast--warning { background: #4a3000; }
.toast--loading { background: var(--bg-surface); color: var(--text-primary); }
.toast__action  {
    margin-inline-start: auto;
    color:      var(--brand-light);
    font-weight:var(--font-weight-semi);
    cursor:     pointer;
    flex-shrink:0;
}
.toast--out { animation: toastOut 180ms ease forwards; }

/* ──────────────────────────────────────────────────────────
   17. VERIFIED BADGE
────────────────────────────────────────────────────────── */
.verified-badge {
    display:        inline-block;
    width:          16px;
    height:         16px;
    color:          var(--brand);
    vertical-align: middle;
    margin-inline-start: 3px;
    flex-shrink:    0;
}
.verified-badge--sm { width: 13px; height: 13px; }

/* ──────────────────────────────────────────────────────────
   18. KEYBOARD SHORTCUT
────────────────────────────────────────────────────────── */
kbd {
    display:        inline-flex;
    align-items:    center;
    padding:        2px 6px;
    background:     var(--bg-surface-3);
    border:         1px solid var(--border-strong);
    border-radius:  var(--radius-sm);
    font-size:      var(--font-size-xs);
    font-family:    var(--font-family-mono);
    color:          var(--text-secondary);
}

/* ──────────────────────────────────────────────────────────
   19. REDUCE MOTION
────────────────────────────────────────────────────────── */
@media (prefers-reduced-motion: reduce) {
    *, *::before, *::after {
        animation-duration:        0.01ms !important;
        animation-iteration-count: 1      !important;
        transition-duration:       0.01ms !important;
    }
}

/* ──────────────────────────────────────────────────────────
   20. PRINT
────────────────────────────────────────────────────────── */
@media print {
    .sidebar, .chat-input-area, .profile-panel { display: none !important; }
    .chat-messages { overflow: visible !important; }
}
