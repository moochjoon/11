/* ============================================================
   ANIMATIONS.CSS  —  Namak Messenger
   Keyframes, transitions, micro-interactions
   ============================================================ */

/* ──────────────────────────────────────────────────────────
   1. CORE KEYFRAMES
────────────────────────────────────────────────────────── */
@keyframes fadeIn {
    from { opacity: 0; }
    to   { opacity: 1; }
}
@keyframes fadeOut {
    from { opacity: 1; }
    to   { opacity: 0; }
}
@keyframes slideUp {
    from { opacity: 0; transform: translateY(20px) scale(.97); }
    to   { opacity: 1; transform: translateY(0)    scale(1);   }
}
@keyframes slideDown {
    from { opacity: 0; transform: translateY(-16px); }
    to   { opacity: 1; transform: translateY(0);     }
}
@keyframes slideInEnd {
    from { opacity: 0; transform: translateX(32px); }
    to   { opacity: 1; transform: translateX(0);    }
}
@keyframes slideInStart {
    from { opacity: 0; transform: translateX(-32px); }
    to   { opacity: 1; transform: translateX(0);     }
}
@keyframes scaleIn {
    from { opacity: 0; transform: scale(.85); }
    to   { opacity: 1; transform: scale(1);   }
}
@keyframes scaleOut {
    from { opacity: 1; transform: scale(1);   }
    to   { opacity: 0; transform: scale(.85); }
}
@keyframes spin {
    to { transform: rotate(360deg); }
}
@keyframes pulse {
    0%, 100% { box-shadow: 0 0 0 0 rgba(255, 59, 48, .5); }
    50%       { box-shadow: 0 0 0 8px rgba(255, 59, 48, 0); }
}
@keyframes blink {
    0%, 100% { opacity: 1; }
    50%       { opacity: 0; }
}
@keyframes float {
    0%, 100% { transform: translateY(0); }
    50%       { transform: translateY(-6px); }
}
@keyframes shake {
    0%, 100% { transform: translateX(0); }
    20%       { transform: translateX(-6px); }
    40%       { transform: translateX(6px);  }
    60%       { transform: translateX(-4px); }
    80%       { transform: translateX(4px);  }
}
@keyframes popIn {
    0%   { opacity: 0; transform: scale(0) rotate(-10deg); }
    70%  { transform: scale(1.15) rotate(4deg); }
    100% { opacity: 1; transform: scale(1) rotate(0);      }
}
@keyframes bounceIn {
    0%   { opacity: 0; transform: scale(.3);   }
    50%  { opacity: 1; transform: scale(1.05); }
    70%  { transform: scale(.9);  }
    100% { transform: scale(1);   }
}
@keyframes shimmer {
    0%   { background-position: 200% 0;  }
    100% { background-position: -200% 0; }
}
@keyframes toastIn {
    from { opacity: 0; transform: translateY(12px) scale(.95); }
    to   { opacity: 1; transform: translateY(0)    scale(1);   }
}
@keyframes toastOut {
    from { opacity: 1; transform: translateY(0)    scale(1);   }
    to   { opacity: 0; transform: translateY(8px)  scale(.95); }
}
@keyframes voiceWave {
    from { height: 4px;  }
    to   { height: 26px; }
}
@keyframes callPulse {
    0%, 100% { box-shadow: 0 0 0 0   rgba(91,94,166,.5), 0 0 0 0   rgba(91,94,166,.3); }
    50%       { box-shadow: 0 0 0 16px rgba(91,94,166,0),  0 0 0 32px rgba(91,94,166,0); }
}
@keyframes typingDot {
    0%, 60%, 100% { transform: translateY(0);    opacity: .4;  }
    30%            { transform: translateY(-5px); opacity: 1;   }
}
@keyframes ripple {
    to { transform: scale(3); opacity: 0; }
}
@keyframes swipeHint {
    0%   { transform: translateX(0);   opacity: 1;   }
    50%  { transform: translateX(-20px);opacity: .6; }
    100% { transform: translateX(0);   opacity: 1;   }
}
@keyframes notifBounce {
    0%   { transform: scale(1);    }
    30%  { transform: scale(1.25); }
    50%  { transform: scale(.9);   }
    70%  { transform: scale(1.1);  }
    100% { transform: scale(1);    }
}
@keyframes slideFromRight {
    from { transform: translateX(100%); }
    to   { transform: translateX(0); }
}
@keyframes slideFromLeft {
    from { transform: translateX(-100%); }
    to   { transform: translateX(0); }
}
@keyframes zoomFade {
    from { opacity: 0; transform: scale(1.06); }
    to   { opacity: 1; transform: scale(1);    }
}

/* ──────────────────────────────────────────────────────────
   2. MESSAGE ENTRANCE
────────────────────────────────────────────────────────── */
.msg-row--new-in {
    animation: msgEnterIn 220ms var(--transition-spring) forwards;
}
.msg-row--new-out {
    animation: msgEnterOut 220ms var(--transition-spring) forwards;
}

@keyframes msgEnterIn {
    from { opacity: 0; transform: translateX(-16px) scale(.96); }
    to   { opacity: 1; transform: translateX(0)     scale(1);   }
}
@keyframes msgEnterOut {
    from { opacity: 0; transform: translateX(16px) scale(.96); }
    to   { opacity: 1; transform: translateX(0)    scale(1);   }
}

/* ──────────────────────────────────────────────────────────
   3. TYPING INDICATOR
────────────────────────────────────────────────────────── */
.typing-indicator {
    display:        inline-flex;
    align-items:    center;
    gap:            3px;
    padding:        8px 14px;
    background:     var(--bubble-in);
    border-radius:  var(--radius-bubble-in);
    box-shadow:     var(--bubble-in-shadow);
}
.typing-dot {
    width:          7px;
    height:         7px;
    background:     var(--text-tertiary);
    border-radius:  50%;
    animation:      typingDot 1.4s ease-in-out infinite;
}
.typing-dot:nth-child(2) { animation-delay: 200ms; }
.typing-dot:nth-child(3) { animation-delay: 400ms; }

/* ──────────────────────────────────────────────────────────
   4. RIPPLE EFFECT
────────────────────────────────────────────────────────── */
.ripple-container {
    position:   relative;
    overflow:   hidden;
}
.ripple-wave {
    position:   absolute;
    border-radius: 50%;
    background: rgba(255,255,255,.3);
    width:      1px;
    height:     1px;
    transform:  scale(0);
    animation:  ripple 600ms ease-out forwards;
    pointer-events: none;
}
[data-theme="dark"] .ripple-wave { background: rgba(255,255,255,.15); }

/* ──────────────────────────────────────────────────────────
   5. SEND BUTTON MORPHING
────────────────────────────────────────────────────────── */
.chat-input-send--send  { animation: scaleIn 200ms var(--transition-spring); }
.chat-input-send--voice { animation: scaleIn 200ms var(--transition-spring); }
.chat-input-send svg    { transition: transform 200ms var(--transition-spring), opacity 150ms ease; }

/* ──────────────────────────────────────────────────────────
   6. CHAT LIST ITEM ANIMATIONS
────────────────────────────────────────────────────────── */
.chat-item--new {
    animation: slideInEnd 240ms var(--transition-spring) forwards;
}
.chat-item--removed {
    animation: fadeOut 180ms ease forwards;
    overflow:  hidden;
    max-height: 80px;
    transition: max-height 200ms ease;
}
.chat-item:focus-visible { background: var(--brand-alpha-10); }

/* ──────────────────────────────────────────────────────────
   7. BADGE BOUNCE
────────────────────────────────────────────────────────── */
.chat-item__badge--new {
    animation: notifBounce 400ms var(--transition-spring);
}

/* ──────────────────────────────────────────────────────────
   8. UNREAD DIVIDER
────────────────────────────────────────────────────────── */
.msg-unread-divider {
    display:        flex;
    align-items:    center;
    justify-content:center;
    margin:         var(--sp-4) 0 var(--sp-2);
    animation:      fadeIn 300ms ease;
}
.msg-unread-divider span {
    background:     var(--brand-alpha-20);
    color:          var(--brand);
    font-size:      var(--font-size-xs);
    font-weight:    var(--font-weight-semi);
    padding:        3px 14px;
    border-radius:  var(--radius-full);
}

/* ──────────────────────────────────────────────────────────
   9. SWIPE ACTION INDICATORS
────────────────────────────────────────────────────────── */
.chat-item__swipe-left,
.chat-item__swipe-right {
    position:       absolute;
    top:            0;
    bottom:         0;
    width:          72px;
    display:        flex;
    align-items:    center;
    justify-content:center;
    font-size:      22px;
    opacity:        0;
    transition:     opacity var(--transition-fast);
    pointer-events: none;
}
.chat-item__swipe-left {
    inset-inline-end: 0;
    background:     linear-gradient(to left, var(--warning-bg), transparent);
}
.chat-item__swipe-right {
    inset-inline-start: 0;
    background:     linear-gradient(to right, var(--success-bg), transparent);
}
.chat-item--swiping-left  .chat-item__swipe-left  { opacity: 1; }
.chat-item--swiping-right .chat-item__swipe-right { opacity: 1; }

/* ──────────────────────────────────────────────────────────
   10. PAGE TRANSITIONS
────────────────────────────────────────────────────────── */
.page-enter  { animation: slideFromRight 260ms var(--transition-slide) forwards; }
.page-exit   { animation: slideFromLeft  260ms var(--transition-slide) reverse forwards; }

/* ──────────────────────────────────────────────────────────
   11. PROFILE PANEL OPEN/CLOSE
────────────────────────────────────────────────────────── */
.profile-panel {
    transition: transform var(--transition-slide);
}
.profile-panel--open {
    animation: slideInEnd 260ms var(--transition-slide) forwards;
}

/* ──────────────────────────────────────────────────────────
   12. EMOJI ANIMATIONS
────────────────────────────────────────────────────────── */
.emoji-btn--selected {
    animation: popIn 300ms var(--transition-spring);
}
.emoji-float {
    position:       fixed;
    pointer-events: none;
    font-size:      28px;
    z-index:        var(--z-toast);
    animation:      emojiFloat 800ms ease-out forwards;
}
@keyframes emojiFloat {
    0%   { opacity: 1; transform: translateY(0)     scale(1);    }
    100% { opacity: 0; transform: translateY(-80px) scale(1.4);  }
}

/* ──────────────────────────────────────────────────────────
   13. REACTION ENTRANCE
────────────────────────────────────────────────────────── */
.msg-reaction--new {
    animation: bounceIn 300ms var(--transition-spring);
}

/* ──────────────────────────────────────────────────────────
   14. ONLINE STATUS PULSE
────────────────────────────────────────────────────────── */
.avatar__online--just-online {
    animation: onlinePulse 600ms ease-out;
}
@keyframes onlinePulse {
    0%   { transform: scale(1);   box-shadow: 0 0 0 0   rgba(52,199,89,.6); }
    50%  { transform: scale(1.4); box-shadow: 0 0 0 6px rgba(52,199,89,0); }
    100% { transform: scale(1);   box-shadow: none; }
}

/* ──────────────────────────────────────────────────────────
   15. BUTTON INTERACTIONS
────────────────────────────────────────────────────────── */
.btn {
    position:   relative;
    overflow:   hidden;
}
.btn::after {
    content:        '';
    position:       absolute;
    inset:          0;
    background:     rgba(255,255,255,0);
    transition:     background var(--transition-fast);
    border-radius:  inherit;
    pointer-events: none;
}
.btn:active::after { background: rgba(255,255,255,.15); }

/* ──────────────────────────────────────────────────────────
   16. CALL RING ANIMATION
────────────────────────────────────────────────────────── */
.call-ring {
    position:       absolute;
    inset:          -16px;
    border-radius:  50%;
    border:         2px solid rgba(91,94,166,.6);
    animation:      callRing 2s ease-out infinite;
}
.call-ring:nth-child(2) { animation-delay: .5s; }
.call-ring:nth-child(3) { animation-delay: 1s;  }

@keyframes callRing {
    0%   { transform: scale(1);    opacity: .7; }
    100% { transform: scale(1.6);  opacity: 0;  }
}

/* ──────────────────────────────────────────────────────────
   17. SPINNING (sync button)
────────────────────────────────────────────────────────── */
.spinning svg,
.spinning .icon { animation: spin 700ms linear infinite; }

/* ──────────────────────────────────────────────────────────
   18. HIGHLIGHT FLASH (scroll-to message)
────────────────────────────────────────────────────────── */
.msg-bubble--highlight {
    animation: highlight 1.2s ease forwards;
}
@keyframes highlight {
    0%   { background: var(--brand-alpha-20); }
    100% { background: inherit; }
}

/* ──────────────────────────────────────────────────────────
   19. SIDEBAR SWIPE HINT (first-run)
────────────────────────────────────────────────────────── */
.swipe-hint { animation: swipeHint 1.5s ease-in-out 2; }

/* ──────────────────────────────────────────────────────────
   20. NUMBER ODOMETER (unread count change)
────────────────────────────────────────────────────────── */
.badge--tick-up   { animation: tickUp   200ms var(--transition-spring); }
.badge--tick-down { animation: tickDown 200ms var(--transition-spring); }

@keyframes tickUp {
    0%   { transform: translateY(6px);  opacity: 0; }
    100% { transform: translateY(0);    opacity: 1; }
}
@keyframes tickDown {
    0%   { transform: translateY(-6px); opacity: 0; }
    100% { transform: translateY(0);    opacity: 1; }
}
